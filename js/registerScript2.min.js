var fbRedirect=0;function statusChangeCallback(response){if(response.status==="connected"){document.
getElementById("status").innerHTML="";testAPI();}else{if(response.status==="not_authorized"){documen
t.getElementById("status").innerHTML="Please log into this
app.";}else{document.getElementById("status").innerHTML="Please log into Facebook.";}}}function
checkLoginState(){FB.getLoginStatus(function(response){statusChangeCallback(response);});}function f
acebookLogin(){FB.login(function(response){if(response.authResponse){testAPI();fbRedirect=1;}else{co
nsole.log("User cancelled login or did not fully authorize.");}},{scope:"public_profile,email,user_l
ocation,user_education_history,user_likes"});}window.fbAsyncInit=function(){FB.init({appId:"57024329
6401349",cookie:true,xfbml:true,version:"v2.1"});FB.getLoginStatus(function(response){statusChangeCa
llback(response);});};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(
id)){return;}js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/sdk.js";fjs.parentN
ode.insertBefore(js,fjs);}(document,"script","facebook-jssdk"));function
testAPI(){FB.api("/me",function(response){console.log(response);var currentcity=((response.location.
name).indexOf(",")===-1)?(response.location.name):((response.location.name).substring(0,(response.lo
cation.name).indexOf(",")));$("#userName").val(response.name);if(response.gender=="male"){$(":radio[
value=male]").attr("checked",true);}else{if(response.gender=="female"){$(":radio[value=female]").att
r("checked",true);}}$("#userEmail").val(response.email);$("#userLocation").val(currentcity);$("#user
School").val(response.education[0].school.name);$("#fbLink").val(response.link);});}$(window).load(f
unction(){$("#submitBus").click(function(e){$.ajax({url:"/2014/busComer/",type:"POST",data:$("#busSe
rviceForm").serialize(),success:function(data){var obj=$.parseJSON(data);$(".step1").css("display","
none");$(".step1").html(String(data));$("#busForm").html(obj.message);$(".step3").css("display","non
e");}});});});$(window).load(function(){$("#submitForm").click(function(e){var
error="";e.preventDefault();var phoVal=$("#phoneno").val();var phoReg=/^([0-9]{10})$/;var
phoAltVal=$("#phonenoAlt").val();if(phoAltVal!=""){var phoAltTest=phoReg.test(phoAltVal);}var
phoTest=phoReg.test(phoVal);var emaVal=$("#userEmail").val();var
emaReg=/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/;var
emaTest=emaReg.test(emaVal);var namVal=$("#userName").val();var
genVal=$("#userGender:checked").val();var emaVal=$("#userEmail").val();var
locVal=$("#userLocation").val();var schVal=$("#userSchool").val();var
empty=(namVal=="")||(genVal==undefined)||(emaVal=="")||(locVal=="")||(schVal=="");var contact=(phoAl
tVal!="")?(phoTest&&phoAltTest):(phoTest);if(contact&&emaTest&&!(empty)){if(fbRedirect==1){FB.api("/
me/likes/243318882409289",function(response){console.log(response);like=response.data.length;if(like
==1){$("#submitForm").css("background-color","#ccc");$.ajax({url:"/2014/register/",type:"POST",data:
$("#regDetail").serialize(),success:function(data){var obj=$.parseJSON(data);$(".step1").css("displa
y","none");$("#status").html(obj.message);$(".step3").css("display","block");if(obj.status!=1){$("#b
usForm").css("display","none");}}});}else{alert("Like our Facebook Page
!");}});}else{$("#submitForm").css("background-color","#ccc");$.ajax({url:"/2014/register/",type:"PO
ST",data:$("#regDetail").serialize(),success:function(data){var obj=$.parseJSON(data);$(".step1").cs
s("display","none");$("#status").html(obj.message);$(".step3").css("display","block");if(obj.status!
=1){$("#busForm").css("display","none");}}});}}else{if(!contact){if(!phoVal){error="Please enter 10
digit Mobile number without +91 or 0 prefix.";}if(phoAltVal!=""&&!phoAltTest){error="\nAlternate
Mobile number is Invalid";}}if(!emaTest){error=error+"\nPlease enter a valid email
ID.";}if(empty){error=error+"\nPlease fill all the information.";}alert(error);}});});
